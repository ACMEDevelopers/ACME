% function [tout,X,MX,Y] = IOS_geneExp_IOS_matlab(t,theta,kappa) 
function varargout = IOS_geneExp_IOS_matlab(varargin) 

t = varargin{1};
theta = varargin{2};
if(nargin>=3)
    kappa=varargin{3};
   if(length(kappa)==1)
    kappa(2:29)=0;
   end
else
    kappa = zeros(1,29);
end
% Initial conditions
x0 = x0fun(theta,kappa);

% Simulation
[tout,X] = ode15s(@(t,x) rhs(t,x,theta,kappa),t,x0);
Y = rhsO(t,X,theta,kappa);

% Assign output
varargout{1} = tout;
if nargout >= 2
varargout{2} = X;
end
if nargout >= 3
    % Moments of species
    varargout{3} = Y(:,1:34);
end
if nargout >= 4
    % Moments of output variables
    varargout{4} = Y(:,35:end);
end
if nargout >= 5
    error('Too many output arguments.');
end


%% RIGHT-HAND SIDE
function [dxdt] = rhs(t,x,theta,kappa) 

dxdt = [theta(2)*x(2) - theta(1)*x(1) - kappa(1)*theta(7)*x(1)*x(4);...
         theta(1)*x(1) - theta(2)*x(2) + kappa(1)*theta(7)*x(1)*x(4);...
         theta(3)*x(2) - theta(4)*x(3);...
         theta(5)*x(3) - theta(6)*x(4);...
         (theta(1)*x(1) + theta(2)*x(2) - 2*kappa(1)*theta(1)*x(5) + 2*kappa(1)*theta(2)*x(6) + kappa(1)*theta(7)*x(1)*x(4) - 2*kappa(1)^2*theta(7)*x(4)*x(5) - 2*kappa(1)^2*theta(7)*x(1)*x(11))/kappa(1);...
         -(kappa(1)^2*theta(2)*x(6) - kappa(1)^2*theta(2)*x(7) - kappa(1)^2*x(5)*(theta(1) + kappa(1)*theta(7)*x(4)) + kappa(1)^2*x(6)*(theta(1) + kappa(1)*theta(7)*x(4)) + kappa(1)*theta(1)*x(1) + kappa(1)*theta(2)*x(2) + kappa(1)^2*theta(7)*x(1)*x(4) - kappa(1)^3*theta(7)*x(1)*x(11) + kappa(1)^3*theta(7)*x(1)*x(12))/kappa(1)^2;...
         (theta(1)*x(1) + theta(2)*x(2) + 2*kappa(1)*theta(1)*x(6) - 2*kappa(1)*theta(2)*x(7) + kappa(1)*theta(7)*x(1)*x(4) + 2*kappa(1)^2*theta(7)*x(4)*x(6) + 2*kappa(1)^2*theta(7)*x(1)*x(12))/kappa(1);...
         theta(3)*x(6) - theta(1)*x(8) + theta(2)*x(9) - theta(4)*x(8) - kappa(1)*theta(7)*x(4)*x(8) - kappa(1)*theta(7)*x(1)*x(13);...
         theta(1)*x(8) + theta(3)*x(7) - theta(2)*x(9) - theta(4)*x(9) + kappa(1)*theta(7)*x(4)*x(8) + kappa(1)*theta(7)*x(1)*x(13);...
         (theta(3)*x(2) + theta(4)*x(3) + 2*kappa(1)*theta(3)*x(9) - 2*kappa(1)*theta(4)*x(10))/kappa(1);...
         theta(5)*x(8) - theta(1)*x(11) + theta(2)*x(12) - theta(6)*x(11) - kappa(1)*theta(7)*x(1)*x(14) - kappa(1)*theta(7)*x(4)*x(11);...
         theta(1)*x(11) - theta(2)*x(12) + theta(5)*x(9) - theta(6)*x(12) + kappa(1)*theta(7)*x(1)*x(14) + kappa(1)*theta(7)*x(4)*x(11);...
         theta(3)*x(12) + theta(5)*x(10) - theta(4)*x(13) - theta(6)*x(13);...
         (theta(5)*x(3) + theta(6)*x(4) + 2*kappa(1)*theta(5)*x(13) - 2*kappa(1)*theta(6)*x(14))/kappa(1);...
         theta(2)*x(16) - theta(1)*x(15) - kappa(1)*theta(7)*x(11) - kappa(1)*theta(7)*x(1)*x(18) - kappa(1)*theta(7)*x(4)*x(15);...
         theta(1)*x(15) - theta(2)*x(16) + kappa(1)*theta(7)*x(11) + kappa(1)*theta(7)*x(1)*x(18) + kappa(1)*theta(7)*x(4)*x(15);...
         theta(3)*x(16) - theta(4)*x(17);...
         theta(5)*x(17) - theta(6)*x(18);...
         (kappa(1)^2*theta(7)*x(11) + 2*kappa(1)^2*theta(2)*x(20) - 2*kappa(1)^3*theta(7)*x(39) + 2*kappa(1)*x(15)*(theta(1)/2 + (kappa(1)*theta(7)*x(4))/2) - 2*kappa(1)^2*x(19)*(theta(1) + kappa(1)*theta(7)*x(4)) + kappa(1)*theta(2)*x(16) + kappa(1)^2*theta(7)*x(1)*x(18) - 2*kappa(1)^3*theta(7)*x(1)*x(25))/kappa(1)^2;...
         -(kappa(1)^2*theta(7)*x(11) + kappa(1)^2*theta(2)*x(20) - kappa(1)^2*theta(2)*x(21) - kappa(1)^3*theta(7)*x(39) + kappa(1)^3*theta(7)*x(40) + 2*kappa(1)*x(15)*(theta(1)/2 + (kappa(1)*theta(7)*x(4))/2) - kappa(1)^2*x(19)*(theta(1) + kappa(1)*theta(7)*x(4)) + kappa(1)^2*x(20)*(theta(1) + kappa(1)*theta(7)*x(4)) + kappa(1)*theta(2)*x(16) + kappa(1)^2*theta(7)*x(1)*x(18) - kappa(1)^3*theta(7)*x(1)*x(25) + kappa(1)^3*theta(7)*x(1)*x(26))/kappa(1)^2;...
         (kappa(1)^2*theta(7)*x(11) - 2*kappa(1)^2*theta(2)*x(21) + 2*kappa(1)^3*theta(7)*x(40) + 2*kappa(1)*x(15)*(theta(1)/2 + (kappa(1)*theta(7)*x(4))/2) + 2*kappa(1)^2*x(20)*(theta(1) + kappa(1)*theta(7)*x(4)) + kappa(1)*theta(2)*x(16) + kappa(1)^2*theta(7)*x(1)*x(18) + 2*kappa(1)^3*theta(7)*x(1)*x(26))/kappa(1)^2;...
         theta(3)*x(20) - theta(1)*x(22) + theta(2)*x(23) - theta(4)*x(22) - kappa(1)*theta(7)*x(42) - kappa(1)*theta(7)*x(4)*x(22) - kappa(1)*theta(7)*x(1)*x(27);...
         theta(1)*x(22) + theta(3)*x(21) - theta(2)*x(23) - theta(4)*x(23) + kappa(1)*theta(7)*x(42) + kappa(1)*theta(7)*x(4)*x(22) + kappa(1)*theta(7)*x(1)*x(27);...
         (theta(3)*x(16) + theta(4)*x(17) + 2*kappa(1)*theta(3)*x(23) - 2*kappa(1)*theta(4)*x(24))/kappa(1);...
         theta(5)*x(22) - theta(1)*x(25) + theta(2)*x(26) - theta(6)*x(25) - kappa(1)*theta(7)*x(45) - kappa(1)*theta(7)*x(1)*x(28) - kappa(1)*theta(7)*x(4)*x(25);...
         theta(1)*x(25) - theta(2)*x(26) + theta(5)*x(23) - theta(6)*x(26) + kappa(1)*theta(7)*x(45) + kappa(1)*theta(7)*x(1)*x(28) + kappa(1)*theta(7)*x(4)*x(25);...
         theta(3)*x(26) + theta(5)*x(24) - theta(4)*x(27) - theta(6)*x(27);...
         (theta(5)*x(17) + theta(6)*x(18) + 2*kappa(1)*theta(5)*x(27) - 2*kappa(1)*theta(6)*x(28))/kappa(1);...
         (3*kappa(1)^2*theta(2)*x(6) + 3*kappa(1)^3*theta(2)*x(30) + 3*kappa(1)^2*x(5)*(theta(1) + kappa(1)*theta(7)*x(4)) - 3*kappa(1)^3*x(29)*(theta(1) + kappa(1)*theta(7)*x(4)) + 3*kappa(1)*x(15)*(kappa(1)*theta(1)*x(1) + kappa(1)*theta(2)*x(2) + kappa(1)^2*theta(7)*x(1)*x(4)) - kappa(1)*theta(1)*x(1) + kappa(1)*theta(2)*x(2) - kappa(1)^2*theta(7)*x(1)*x(4) + 3*kappa(1)^3*theta(7)*x(1)*x(11) - 9*kappa(1)^4*theta(7)*x(5)*x(11) - 3*kappa(1)^4*theta(7)*x(1)*x(39))/kappa(1)^3;...
         (kappa(1)^2*theta(2)*x(7) - 2*kappa(1)^2*theta(2)*x(6) - kappa(1)^3*theta(2)*x(30) + 2*kappa(1)^3*theta(2)*x(31) - 2*kappa(1)^2*x(5)*(theta(1) + kappa(1)*theta(7)*x(4)) + kappa(1)^2*x(6)*(theta(1) + kappa(1)*theta(7)*x(4)) + kappa(1)^3*x(29)*(theta(1) + kappa(1)*theta(7)*x(4)) - 2*kappa(1)^3*x(30)*(theta(1) + kappa(1)*theta(7)*x(4)) - 2*kappa(1)^4*theta(7)*(x(5)*x(12) + 2*x(6)*x(11)) + kappa(1)*theta(1)*x(1) - kappa(1)*theta(2)*x(2) - 2*kappa(1)^2*x(15)*(theta(1)*x(1) + theta(2)*x(2) + kappa(1)*theta(7)*x(1)*x(4)) + kappa(1)^2*x(16)*(theta(1)*x(1) + theta(2)*x(2) + kappa(1)*theta(7)*x(1)*x(4)) + kappa(1)^2*theta(7)*x(1)*x(4) - 2*kappa(1)^3*theta(7)*x(1)*x(11) + kappa(1)^3*theta(7)*x(1)*x(12) + 3*kappa(1)^4*theta(7)*x(5)*x(11) + kappa(1)^4*theta(7)*x(1)*x(39) - 2*kappa(1)^4*theta(7)*x(1)*x(40))/kappa(1)^3;...
         -(2*kappa(1)^2*theta(2)*x(7) - kappa(1)^2*theta(2)*x(6) + 2*kappa(1)^3*theta(2)*x(31) - kappa(1)^3*theta(2)*x(32) - kappa(1)^2*x(5)*(theta(1) + kappa(1)*theta(7)*x(4)) + 2*kappa(1)^2*x(6)*(theta(1) + kappa(1)*theta(7)*x(4)) - 2*kappa(1)^3*x(30)*(theta(1) + kappa(1)*theta(7)*x(4)) + kappa(1)^3*x(31)*(theta(1) + kappa(1)*theta(7)*x(4)) - 2*kappa(1)^4*theta(7)*(x(5)*x(12) + 2*x(6)*x(11)) + kappa(1)^4*theta(7)*(2*x(6)*x(12) + x(7)*x(11)) + kappa(1)*theta(1)*x(1) - kappa(1)*theta(2)*x(2) - kappa(1)^2*x(15)*(theta(1)*x(1) + theta(2)*x(2) + kappa(1)*theta(7)*x(1)*x(4)) + 2*kappa(1)^2*x(16)*(theta(1)*x(1) + theta(2)*x(2) + kappa(1)*theta(7)*x(1)*x(4)) + kappa(1)^2*theta(7)*x(1)*x(4) - kappa(1)^3*theta(7)*x(1)*x(11) + 2*kappa(1)^3*theta(7)*x(1)*x(12) - 2*kappa(1)^4*theta(7)*x(1)*x(40) + kappa(1)^4*theta(7)*x(1)*x(41))/kappa(1)^3;...
         (3*theta(7)*(2*kappa(1)^4*x(6)*x(12) + kappa(1)^4*x(7)*x(11)) + 3*kappa(1)^2*theta(2)*x(7) - 3*kappa(1)^3*theta(2)*x(32) + 3*kappa(1)^2*x(6)*(theta(1) + kappa(1)*theta(7)*x(4)) + 3*kappa(1)^3*x(31)*(theta(1) + kappa(1)*theta(7)*x(4)) + 3*kappa(1)*x(16)*(kappa(1)*theta(1)*x(1) + kappa(1)*theta(2)*x(2) + kappa(1)^2*theta(7)*x(1)*x(4)) + kappa(1)*theta(1)*x(1) - kappa(1)*theta(2)*x(2) + kappa(1)^2*theta(7)*x(1)*x(4) + 3*kappa(1)^3*theta(7)*x(1)*x(12) + 3*kappa(1)^4*theta(7)*x(1)*x(41))/kappa(1)^3;...
         (theta(1)*x(8) + theta(2)*x(9) + kappa(1)*theta(3)*x(30) - 2*kappa(1)*theta(1)*x(33) + 2*kappa(1)*theta(2)*x(34) - kappa(1)*theta(4)*x(33) + theta(1)*x(1)*x(17) + theta(2)*x(2)*x(17) + kappa(1)*theta(7)*x(4)*x(8) + kappa(1)*theta(7)*x(1)*x(13) - 2*kappa(1)^2*theta(7)*x(5)*x(13) - 4*kappa(1)^2*theta(7)*x(8)*x(11) - 2*kappa(1)^2*theta(7)*x(4)*x(33) - 2*kappa(1)^2*theta(7)*x(1)*x(42) + kappa(1)*theta(7)*x(1)*x(4)*x(17))/kappa(1);...
         -(theta(1)*x(8) + theta(2)*x(9) - kappa(1)*theta(1)*x(33) - kappa(1)*theta(3)*x(31) + kappa(1)*theta(1)*x(34) + kappa(1)*theta(2)*x(34) - kappa(1)*theta(2)*x(35) + kappa(1)*theta(4)*x(34) + theta(1)*x(1)*x(17) + theta(2)*x(2)*x(17) + kappa(1)*theta(7)*x(4)*x(8) + kappa(1)*theta(7)*x(1)*x(13) - kappa(1)^2*theta(7)*x(5)*x(13) + kappa(1)^2*theta(7)*x(6)*x(13) - 2*kappa(1)^2*theta(7)*x(8)*x(11) + kappa(1)^2*theta(7)*x(8)*x(12) + kappa(1)^2*theta(7)*x(9)*x(11) - kappa(1)^2*theta(7)*x(4)*x(33) + kappa(1)^2*theta(7)*x(4)*x(34) - kappa(1)^2*theta(7)*x(1)*x(42) + kappa(1)^2*theta(7)*x(1)*x(43) + kappa(1)*theta(7)*x(1)*x(4)*x(17))/kappa(1);...
         (theta(1)*x(8) + theta(2)*x(9) + 2*kappa(1)*theta(1)*x(34) + kappa(1)*theta(3)*x(32) - 2*kappa(1)*theta(2)*x(35) - kappa(1)*theta(4)*x(35) + theta(1)*x(1)*x(17) + theta(2)*x(2)*x(17) + kappa(1)*theta(7)*x(4)*x(8) + kappa(1)*theta(7)*x(1)*x(13) + 2*kappa(1)^2*theta(7)*x(6)*x(13) + 2*kappa(1)^2*theta(7)*x(8)*x(12) + 2*kappa(1)^2*theta(7)*x(9)*x(11) + 2*kappa(1)^2*theta(7)*x(4)*x(34) + 2*kappa(1)^2*theta(7)*x(1)*x(43) + kappa(1)*theta(7)*x(1)*x(4)*x(17))/kappa(1);...
         (theta(3)*x(6) + theta(4)*x(8) - kappa(1)*theta(1)*x(36) + 2*kappa(1)*theta(3)*x(34) + kappa(1)*theta(2)*x(37) - 2*kappa(1)*theta(4)*x(36) + theta(3)*x(2)*x(15) + theta(4)*x(3)*x(15) - 2*kappa(1)^2*theta(7)*x(8)*x(13) - kappa(1)^2*theta(7)*x(10)*x(11) - kappa(1)^2*theta(7)*x(4)*x(36) - kappa(1)^2*theta(7)*x(1)*x(44))/kappa(1);...
         (theta(3)*x(7) + theta(4)*x(9) + kappa(1)*theta(1)*x(36) + 2*kappa(1)*theta(3)*x(35) - kappa(1)*theta(2)*x(37) - 2*kappa(1)*theta(4)*x(37) + theta(3)*x(2)*x(16) + theta(4)*x(3)*x(16) + 2*kappa(1)^2*theta(7)*x(8)*x(13) + kappa(1)^2*theta(7)*x(10)*x(11) + kappa(1)^2*theta(7)*x(4)*x(36) + kappa(1)^2*theta(7)*x(1)*x(44))/kappa(1);...
         (theta(3)*x(2) - theta(4)*x(3) + 3*kappa(1)^2*theta(3)*x(37) - 3*kappa(1)^2*theta(4)*x(38) + 3*kappa(1)*theta(3)*x(9) + 3*kappa(1)*theta(4)*x(10) + 3*kappa(1)*theta(3)*x(2)*x(17) + 3*kappa(1)*theta(4)*x(3)*x(17))/kappa(1)^2;...
         (theta(1)*x(11) + theta(2)*x(12) - 4*kappa(1)^2*theta(7)*x(11)^2 + kappa(1)*theta(5)*x(33) - 2*kappa(1)*theta(1)*x(39) + 2*kappa(1)*theta(2)*x(40) - kappa(1)*theta(6)*x(39) + theta(1)*x(1)*x(18) + theta(2)*x(2)*x(18) + kappa(1)*theta(7)*x(1)*x(14) + kappa(1)*theta(7)*x(4)*x(11) - 2*kappa(1)^2*theta(7)*x(5)*x(14) - 2*kappa(1)^2*theta(7)*x(4)*x(39) - 2*kappa(1)^2*theta(7)*x(1)*x(45) + kappa(1)*theta(7)*x(1)*x(4)*x(18))/kappa(1);...
         -(theta(7)*(kappa(1)^4*x(6)*x(14) + 2*kappa(1)^4*x(11)*x(12)) - theta(7)*(2*kappa(1)^4*x(11)^2 + kappa(1)^4*x(5)*x(14)) + kappa(1)^2*theta(2)*x(12) - kappa(1)^3*theta(5)*x(34) + kappa(1)^3*theta(2)*x(40) - kappa(1)^3*theta(2)*x(41) + kappa(1)^3*theta(6)*x(40) + kappa(1)^2*x(11)*(theta(1) + kappa(1)*theta(7)*x(4)) - kappa(1)^3*x(39)*(theta(1) + kappa(1)*theta(7)*x(4)) + kappa(1)^3*x(40)*(theta(1) + kappa(1)*theta(7)*x(4)) + kappa(1)*x(18)*(kappa(1)*theta(1)*x(1) + kappa(1)*theta(2)*x(2) + kappa(1)^2*theta(7)*x(1)*x(4)) + kappa(1)^3*theta(7)*x(1)*x(14) - kappa(1)^4*theta(7)*x(1)*x(45) + kappa(1)^4*theta(7)*x(1)*x(46))/kappa(1)^3;...
         (theta(1)*x(11) + theta(2)*x(12) + kappa(1)*theta(5)*x(35) + 2*kappa(1)*theta(1)*x(40) - 2*kappa(1)*theta(2)*x(41) - kappa(1)*theta(6)*x(41) + theta(1)*x(1)*x(18) + theta(2)*x(2)*x(18) + kappa(1)*theta(7)*x(1)*x(14) + kappa(1)*theta(7)*x(4)*x(11) + 2*kappa(1)^2*theta(7)*x(6)*x(14) + 4*kappa(1)^2*theta(7)*x(11)*x(12) + 2*kappa(1)^2*theta(7)*x(4)*x(40) + 2*kappa(1)^2*theta(7)*x(1)*x(46) + kappa(1)*theta(7)*x(1)*x(4)*x(18))/kappa(1);...
         theta(5)*x(36) - theta(1)*x(42) + theta(3)*x(40) + theta(2)*x(43) - theta(4)*x(42) - theta(6)*x(42) - kappa(1)*theta(7)*x(8)*x(14) - 2*kappa(1)*theta(7)*x(11)*x(13) - kappa(1)*theta(7)*x(4)*x(42) - kappa(1)*theta(7)*x(1)*x(47);...
         theta(5)*x(37) + theta(1)*x(42) + theta(3)*x(41) - theta(2)*x(43) - theta(4)*x(43) - theta(6)*x(43) + kappa(1)*theta(7)*x(8)*x(14) + 2*kappa(1)*theta(7)*x(11)*x(13) + kappa(1)*theta(7)*x(4)*x(42) + kappa(1)*theta(7)*x(1)*x(47);...
         (theta(3)*x(12) + theta(4)*x(13) + kappa(1)*theta(5)*x(38) + 2*kappa(1)*theta(3)*x(43) - 2*kappa(1)*theta(4)*x(44) - kappa(1)*theta(6)*x(44) + theta(3)*x(2)*x(18) + theta(4)*x(3)*x(18))/kappa(1);...
         (theta(5)*x(8) + theta(6)*x(11) - kappa(1)*theta(1)*x(45) + 2*kappa(1)*theta(5)*x(42) + kappa(1)*theta(2)*x(46) - 2*kappa(1)*theta(6)*x(45) + theta(5)*x(3)*x(15) + theta(6)*x(4)*x(15) - 3*kappa(1)^2*theta(7)*x(11)*x(14) - kappa(1)^2*theta(7)*x(1)*x(48) - kappa(1)^2*theta(7)*x(4)*x(45))/kappa(1);...
         (theta(5)*x(9) + theta(6)*x(12) + kappa(1)*theta(1)*x(45) - kappa(1)*theta(2)*x(46) + 2*kappa(1)*theta(5)*x(43) - 2*kappa(1)*theta(6)*x(46) + theta(5)*x(3)*x(16) + theta(6)*x(4)*x(16) + 3*kappa(1)^2*theta(7)*x(11)*x(14) + kappa(1)^2*theta(7)*x(1)*x(48) + kappa(1)^2*theta(7)*x(4)*x(45))/kappa(1);...
         (theta(5)*x(10) + theta(6)*x(13) + kappa(1)*theta(3)*x(46) + 2*kappa(1)*theta(5)*x(44) - kappa(1)*theta(4)*x(47) - 2*kappa(1)*theta(6)*x(47) + theta(5)*x(3)*x(17) + theta(6)*x(4)*x(17))/kappa(1);...
         (theta(5)*x(3) - theta(6)*x(4) + 3*kappa(1)^2*theta(5)*x(47) - 3*kappa(1)^2*theta(6)*x(48) + 3*kappa(1)*theta(5)*x(13) + 3*kappa(1)*theta(6)*x(14) + 3*kappa(1)*theta(5)*x(3)*x(18) + 3*kappa(1)*theta(6)*x(4)*x(18))/kappa(1)^2];

%% OUTPUT MAP
function y = rhsO(t,x,theta,kappa) 

y = [x(:,1) + x(:,15),...
         x(:,2) + x(:,16),...
         x(:,3) + x(:,17),...
         x(:,4) + x(:,18),...
         x(:,5) + x(:,19) - x(:,15).^2,...
         x(:,6) + x(:,20) - x(:,15).*x(:,16),...
         x(:,7) + x(:,21) - x(:,16).^2,...
         x(:,8) + x(:,22) - x(:,15).*x(:,17),...
         x(:,9) + x(:,23) - x(:,16).*x(:,17),...
         x(:,10) + x(:,24) - x(:,17).^2,...
         x(:,11) + x(:,25) - x(:,15).*x(:,18),...
         x(:,12) + x(:,26) - x(:,16).*x(:,18),...
         x(:,13) + x(:,27) - x(:,17).*x(:,18),...
         x(:,14) + x(:,28) - x(:,18).^2,...
         x(:,29),...
         x(:,30),...
         x(:,31),...
         x(:,32),...
         x(:,33),...
         x(:,34),...
         x(:,35),...
         x(:,36),...
         x(:,37),...
         x(:,38),...
         x(:,39),...
         x(:,40),...
         x(:,41),...
         x(:,42),...
         x(:,43),...
         x(:,44),...
         x(:,45),...
         x(:,46),...
         x(:,47),...
         x(:,48),...
         theta(9) + theta(8).*(x(:,4) + x(:,18)),...
         theta(8).^2.*(x(:,14) + x(:,28) - x(:,18).^2),...
         theta(8).^3.*x(:,48)];


%% INITIAL CONDITIONS FOR STATE
function x0 = x0fun(theta,kappa) 

x0 = [(kappa(2)*kappa(16) - kappa(2) + 1)/kappa(1);...
       (kappa(3)*kappa(17))/kappa(1);...
       (kappa(4)*kappa(18) - theta(10)*(kappa(4) - 1))/kappa(1);...
       (kappa(5)*kappa(19))/kappa(1);...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0;...
       0];


